<UserControl x:Class="MovieApp.WPF.Controls.AppHeader"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             xmlns:local="clr-namespace:MovieApp.WPF.Controls" 
             xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"
             xmlns:converters="clr-namespace:MovieApp.WPF.Converters"
             xmlns:viewTypes="clr-namespace:MovieApp.WPF.State.Navigator"
             mc:Ignorable="d" 
             d:DesignWidth="800">
    <UserControl.Resources>
        <converters:IsNullConverter x:Key="IsNullConverter" />
    </UserControl.Resources>
    <Grid Background="{StaticResource BrushPrimary3}">
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="auto" />
            <ColumnDefinition Width="*" />
            <ColumnDefinition Width="auto" />
        </Grid.ColumnDefinitions>

        <Button Command="{Binding ChangeViewCommand}"
                CommandParameter="{x:Static viewTypes:ViewType.Home}"
                Style="{StaticResource MaterialDesignFlatButton}"
                Grid.Column="0"
                Foreground="White"
                Background="Transparent"
                Margin="5 5 20 5" 
                Height="auto" >
            <materialDesign:PackIcon Kind="Home"
                                     Width="48"
                                     Height="48"
                                     Margin="-10" />
        </Button>

        <Border Grid.Column="1" CornerRadius="4" Margin="10" Background="White">
            <Grid >
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto" />
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="Auto" />
                </Grid.ColumnDefinitions>

                <Button Style="{DynamicResource MaterialDesignToolButton}">
                    <materialDesign:PackIcon Kind="Search" Opacity="0.8" Width="24" Height="24"/>
                </Button>

                <TextBox
                     Grid.Column="1"
                     Margin="8 0 0 0"
                     materialDesign:HintAssist.Hint="a film/actor to find"
                     materialDesign:TextFieldAssist.DecorationVisibility="Hidden"              
                     BorderThickness="0"
                     MinWidth="200"
                     FontSize="16"
                     VerticalAlignment="Center" />
            </Grid>
        </Border>


        <Menu Grid.Column="2" VerticalAlignment="Center" Margin="5" Background="{StaticResource BrushPrimary3}" RenderOptions.EdgeMode="Aliased" >
            <MenuItem Foreground="White" >

                <MenuItem Header="Profile"
                          Command="{Binding ChangeViewCommand}" 
                          CommandParameter="{x:Static viewTypes:ViewType.Profile}" />

                <MenuItem Header="Sign out"
                          Icon="{materialDesign:PackIcon Kind=SignOut}"
                          Command="{Binding SignOutCommand}" 
                          CommandParameter="{x:Static viewTypes:ViewType.Login}"/>

                <MenuItem.Header>
                    <StackPanel Orientation="Horizontal">
                        <Border Margin="5" BorderThickness="2" BorderBrush="{StaticResource BrushPrimary2}" CornerRadius="50">
                            <Image Width="32" Height="32" Stretch="Fill" RenderOptions.BitmapScalingMode="Fant" RenderOptions.EdgeMode="Aliased">
                            <Image.Style>
                                <Style TargetType="Image">
                                    <Style.Triggers>
                                        <DataTrigger Binding="{Binding ImageData, Converter={StaticResource IsNullConverter}}" Value="True">
                                            <Setter Property="Source" Value="../Resources/default-avatar.png" />
                                        </DataTrigger>
                                        <DataTrigger Binding="{Binding ImageData, Converter={StaticResource IsNullConverter}}" Value="False">
                                            <Setter Property="Source" Value="{Binding ImageData, TargetNullValue={x:Null}}" />
                                        </DataTrigger>
                                    </Style.Triggers>
                                </Style>
                            </Image.Style>
                            <Image.Clip>
                                <EllipseGeometry Center="16,16" RadiusX="16" RadiusY="16" />
                            </Image.Clip>
                        </Image>
                        </Border>
                        <TextBlock Text="{Binding Name}" VerticalAlignment="Center" Margin="5" FontSize="18" />
                    </StackPanel>
                </MenuItem.Header>

            </MenuItem>
        </Menu>
    </Grid>
</UserControl>
